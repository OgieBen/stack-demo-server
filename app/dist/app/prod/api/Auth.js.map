{"version":3,"sources":["../../../../prod/api/auth.js"],"names":["router","factory","Factory","auth","getAuth","get","req","res","next","login","flag","json","msg","signUp","result","getDbc","setUpDb","module","exports"],"mappings":";;AAAA;;AACA;;AAEA,IAAIA,SAAS,sBAAb;;AAGA,IAAIC,UAAU,IAAIC,gBAAJ,EAAd;AACA,IAAIC,OAAOF,QAAQG,OAAR,EAAX;;AAGA;;;;;;;;;;AAUAJ,OAAOK,GAAP,CAAW,QAAX,EAAqB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAqB;;AAEtC;;;AAGI;;;;;;;;;;;;;;;;;AAiBJL,SAAKM,KAAL,CAAW,sBAAX,EAAmC,MAAnC,EAA2C,UAACC,IAAD,EAAU;;AAEzC,YAAGA,IAAH,EAAQ;AACJH,gBAAII,IAAJ,CAAS;AACLC,qBAAK;AADA,aAAT;AAGH;AACA;AACD,YAAGF,SAAS,WAAT,IAAwBA,QAAQ,KAAnC,EAAyC;AACrCH,gBAAII,IAAJ,CAAS;AACLC,qBAAK;AADA,aAAT;AAGH;AAEZ,KAdD;AAgBH,CAtCD;;AAwCA;;;;;;;;;;AAUAZ,OAAOK,GAAP,CAAW,SAAX,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;;AAEtC;;AAEA,QAAIE,OAAO,KAAX;AACAP,SACKU,MADL,CACY,UADZ,EACwB,sBADxB,EACgD,OADhD,EACyD,UAACH,IAAD,EAAU;AAC3D,YAAGA,IAAH,EAAQ;AACAH,gBAAII,IAAJ,CAAS;AACLC,qBAAK;AADA,aAAT;AAGA;AACH;;AAELL,YAAII,IAAJ,CAAS;AACLC,iBAAK;AADA,SAAT;AAGH,KAZL;AAcH,CAnBD;;AAqBAZ,OAAOK,GAAP,CAAW,eAAX,EAA4B,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAmB;;AAE3C;;AAEA;;AAEI;AACA,QAAIM,SAAUb,QACGc,MADH,GAEGC,OAFH,EAAd;;AAIA,QAAIF,MAAJ,EAAW;AACPP,YAAII,IAAJ,CAAS;AACLC,iBAAK;AADA,SAAT;AAGH;;AAEDL,QAAII,IAAJ,CAAS;AACLC,aAAK;AADA,KAAT;;AAKJ;AACH,CAvBD;;AAyBAK,OAAOC,OAAP,GAAiBlB,MAAjB","file":"auth.js","sourcesContent":["import  { Router } from 'express';\nimport { Factory } from '../Factory';\n\nlet router = Router();\n\n\nlet factory = new Factory();\nlet auth = factory.getAuth();\n\n\n/**\n *  This endpoint authenticates a user using th user's password and email \n *  (Note: change method from get to post)\n *  PAYLOAD:\n * @method POST\n * @param String email\n * @param String password\n * \n * @returns JSON\n */\nrouter.get('/login', (req, res, next ) => {\n\n    // TODO: gets user details here\n    \n\n        /* factory\n            .getDbc()\n            .query( 'SELECT NOW()',\n                (err, _result) => {\n                    if(err){\n                        console.log(\"\\nDb Error: \" + err.stack);\n                        return false;\n                    }\n                 \n                     _result\n                        .rows\n                        .forEach((obj) => {\n                            console.log(obj);\n                        }) \n                    console.log(\"\\nResult Lenght \"+_result.rows.length);\n                }); */\n\n    auth.login('bensoft2k5@gmail.com', 'admi', (flag) => {\n\n                if(flag){\n                    res.json({\n                        msg: true,\n                    });\n                 return;\n                }\n                if(flag === 'undefined' || flag == false){\n                    res.json({\n                        msg: false,\n                    });\n                }\n           \n    });\n    \n});\n\n/**\n * This endpoint create a user account\n * \n * @method POST\n * \n * @param String email\n * @param String password\n * \n * @return JSON \n */\nrouter.get('/signup', (req, res, next) => {\n\n    // TODO validate and clean user date\n\n    let flag = false;\n    auth\n        .signUp(\"ogie Ben\", 'bensoft2k5@gmail.com', 'admin', (flag) => {    \n            if(flag){\n                    res.json({\n                        msg: true,\n                    })\n                    return;\n                }\n\n            res.json({\n                msg: false,\n            })\n        });\n\n})\n\nrouter.get('/dbsetup/:key', (req, res, next)=> {\n\n    // let key = req.params.key.toString();\n\n    // if (key ===  \"123\"){\n       \n        // set up db\n        let result =  factory \n                        .getDbc()\n                        .setUpDb();\n\n        if (result){\n            res.json({\n                msg: true,\n            });\n        }\n\n        res.json({\n            msg: false,\n        });\n        \n        \n    // }\n})\n\nmodule.exports = router;\n"]}